{% extends 'base.html' %}

{% block title %}{{ work.title }}{% endblock %}

{% block content %}
<h2>{{ work.title }}</h2>

<p><strong>–ê–≤—Ç–æ—Ä:</strong> {{ work.author.username }}</p>
<p><strong>–ñ–∞–Ω—Ä:</strong> {{ work.get_genre_display }}</p>
<p><strong>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ:</strong> {{ work.published_date|date:"d.m.Y H:i" }}</p>

<hr>

<p>{{ work.content|linebreaks }}</p>

<!-- –ë–ª–æ–∫ —Ä–µ–π—Ç–∏–Ω–≥–∞ -->
<hr>
<h4>–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞:</h4>
<form method="post">
  {% csrf_token %}
  <div class="mb-2">
    <label for="id_score">–û—Ü–µ–Ω–∫–∞ (–æ—Ç 1 –¥–æ 5):</label>
    <input
      type="number"
      name="score"
      id="id_score"
      min="1"
      max="5"
      class="form-control"
      style="max-width: 100px;"
      value="{{ rating_form.score.value|default_if_none:'' }}"
    >
  </div>
  <button type="submit" name="rate_submit" class="btn btn-primary">–û—Ü–µ–Ω–∏—Ç—å</button>
</form>


{% if average_rating %}
  <p class="mt-2">‚≠ê –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞: {{ average_rating|floatformat:1 }} –∏–∑ 5</p>
{% else %}
  <p class="mt-2">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ü–µ–Ω–æ–∫</p>
{% endif %}

<!-- –ë–ª–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
<hr>
<h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>

{% for comment in comments %}
  <div class="mb-2">
    <strong>{{ comment.user.username }}</strong> ({{ comment.created_at|date:"d.m.Y H:i" }}):
    <p>{{ comment.text|linebreaks }}</p>
  </div>
{% empty %}
  <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.</p>
{% endfor %}

<!-- –§–æ—Ä–º–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
<h4 class="mt-4">–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</h4>
<form method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit" class="btn btn-success" name="comment_submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</form>

<!-- –ù–∞–∑–∞–¥ -->
<a href="{% url 'work_list' %}" class="btn btn-secondary mt-4">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
<a href="{% url 'export_work_pdf' work.id %}" class="btn btn-outline-secondary mt-3">üìÑ –°–∫–∞—á–∞—Ç—å PDF</a>

{% endblock %}
